# DivMelt: HRM Diversity Assay Analysis Tool for the R Computing Environment #

---


The HRM Diversity Assay Analysis Tool (DivMelt) is an R package designed to calculate genetic diversity measures from DNA melting curve data. This package enhances the throughput and objectivity of measurements generated with the HRM Diversity Assay.

The text that follows was developed by Matthew M. Cousins <sup>1</sup>, David Swan  <sup>2</sup>, Craig A. Magaret <sup>2</sup>, and Susan H. Eshleman <sup>1</sup>. A PDF of this material with figures is included as a downloadable file (DivMelt Instructions). The code for the R package was written by David Swan <sup>2</sup> with design and testing contributions from Craig A. Magaret <sup>2</sup> and Matthew M. Cousins <sup>1</sup>. The R package is available from the [CRAN repository](http://cran.r-project.org/web/packages/DivMelt/index.html).

  1. Department of Pathology, Johns Hopkins School of Medicine, Baltimore, MD, 21205
  1. Statistical Center for HIV/AIDS Research & Prevention (SCHARP), Fred Hutchinson Cancer Research Center, Seattle, WA 98109

<br>
<br>

<h1>Introduction</h1>
<hr />
<h3>HRM Diversity Assay Background</h3>

The HRM diversity assay allows rapid quantification of DNA diversity without sequencing <a href='1.md'>1</a>. The assay employs analysis of DNA melting curves like those generated in other high resolution melting applications. The melting patterns of these fluorescently labeled nucleic acid populations, specifically the widths of the DNA melting peaks, indicate the levels of diversity in the DNA populations. The peak width has been termed the HRM score. This diversity measure has been previously validated through comparisons between melting data results and sequence diversity derived through a traditional sequence strategy as well as diversity measures derived from next generation sequencing data <a href='2.md'>2</a>. Additionally, higher diversity was observed in individuals who had been infected with HIV for longer periods of time. HIV is known to diversify over time after infection <a href='1.md'>1</a>.<br>
<br>
<h3>Assay Overview</h3>

The HRM diversity assay is based upon the principle that DNA heteroduplexes generated from diverse DNA pools will melt over broader temperature ranges than heteroduplexes generated from less diverse DNA pools. Initially, highly variable nucleic acid pools are amplified via PCR (polymerase chain reaction) in the presence of a duplex-dependent fluorescent dye (LCGreen Plus). Following amplification, a rapid cooling step leads to the formation of fluorescently labeled heteroduplexes. The fluorescently labeled DNA heteroduplexes are subsequently melted, and a highly sensitive camera is used to detect the loss of fluorescence as a function of DNA melting. A melting curve (Fluorescence vs. Temperature) is generated by graphing Fluorescence against Temperature.  By taking the negative derivative of Fluorescence with respect to Temperature (-dF/dT) and graphing this against Temperature, a melting peak is generated. The width of the melting peak corresponds to the HRM score, the diversity output of the HRM diversity assay. In the past, HRM score values have been generated by first selecting the temperature where melting begins (T1) and the temperature where melting is complete (T2) by a manual method. A goniometer was used to select the point where melting begins and is complete while the melting peak was displayed within the LightScanner Instrument and Analysis Software package (Idaho Technology, Salt Lake City, UT). However, this approach has proven to be time consuming, subjective, dependent upon the monitor format, and dependent upon X-axis settings within the program. A standardized and objective method for data analysis is required for analysis of melting curves. The HRM Diversity Assay Analysis Tool (DivMelt) was created to automate the calculation of diversity measures from lab-generated datasets.<br>
<br>
<h3>Introduction to DivMelt</h3>
DivMelt rapidly and objectively calculates diversity measures from HRM data. In general, the calculation is performed in four steps. First, the Fluorescence by Temperature data is modeled. Second, the negative derivative of Fluorescence with respect to Temperature is calculated and modeled against Temperature, and a smoothing line is generated. Third, the temperature at which melting starts and finishes is identified. This is performed by scanning the melting peak for the point where the -dF/dT vs. T smoothing line first rises above a specified angle (Theta 1) and falls below a specified angle to identify T1 and T2 respectively. Fourth, by subtracting T1 from T2, the peak width is calculated. The peak width is the HRM score. This single numeric score serves as a measure of the level of genetic diversity in the sample that was evaluated.<br>
<br>
<br>
<h3>Disclaimer</h3>
The HRM Diversity Assay is for research purposes only and is not suitable as a diagnostic test. DivMelt is provided without any warranty and may be distributed freely as long as its use is appropriately cited.<br>
<br>
<h4>When using DivMelt, please cite as follows:</h4>

Cousins MM, D Swan, CA Magaret, DR Hoover, SH Eshleman. Analysis of HIV Using a High Resolution Melting (HRM) Diversity Assay: Automation of HRM Data Analysis Enhances the Utility of the Assay for Analysis of HIV Incidence. 2012. PLoS ONE 7(12): e51359.<br>
<br>
<br>
<br>
<h1>Installation</h1>
<hr />
<h3>To install and load DivMelt in Windows:</h3>

This installation protocol has been tested for Windows 7 and Windows Vista. A more detailed installation protocol is given in the <a href='http://code.google.com/p/divmelt/downloads/detail?name=DivMelt_HRM_Diversity_Assay_Analysis_Tool_Instruction_Manual_V1.3.pdf&can=2&q=#makechanges'>DivMelt Instruction Manual</a>.<br>
<br>
<ol><li>Download the base version of the R program from the <a href='http://www.r-project.org/'>R project website</a>, and install R by following the on screen prompts.<br>
</li><li>Install the packages “glmnet” and “tcltk2” (required for operation of the HRM Diversity Assay Analysis Tool).<br>
</li><li>Download DivMelt: HRM Diversity Assay Analysis Tool from the [cran.r-project.org/web/packages/DivMelt/index.html CRAN website], and store the file in the directory containing the R executable file.<br>
</li><li>Install the DivMelt package from the windows command prompt by directing the prompt to the proper directory that contains the R execuitable file and entering the following statement: “R.exe CMD INSTALL DivMelt_X.X.X.tar.gz” where “X.X.X” corresponds to the version number of the “DivMelt” package.<br>
</li><li>The package should install.<br>
</li><li>Invoke the package library from the R GUI by entering “library(DivMelt)” and pressing Enter.<br>
</li><li>Initialize the package GUI from the R GUI by entering “DivMelt_gui()” and pressing Enter<br>
</li><li>The DivMelt GUI should open.</li></ol>


<h3>To install DivMelt in MacOS X:</h3>

This installation protocol has been tested for MacOS X 10.6. A more detailed installation protocol is given in the <a href='http://code.google.com/p/divmelt/downloads/detail?name=DivMelt_HRM_Diversity_Assay_Analysis_Tool_Instruction_Manual_V1.3.pdf&can=2&q=#makechanges'>DivMelt Instruction Manual</a>.<br>
<br>
<ol><li>Download the R program from the <a href='http://www.r-project.org/'>R project website</a>, and install R by following the on screen prompts.<br>
</li><li>Download the packages “tcltk utilities”, “glmnet” and “tcltk2” (required for operation of the HRM Diversity Assay Analysis Tool) and load them.<br>
</li><li>Download DivMelt: HRM Diversity Assay Analysis Tool from the [cran.r-project.org/web/packages/DivMelt/index.html CRAN website], and store the file on the desktop.<br>
</li><li>Install the DivMelt package from “Terminal” by entering “R CMD INSTALL /Users/username/Desktop/DivMelt_X.X.X.tar.gz” (replace the text” /Users/username/Desktop/” with the proper path to the file for the installation machine) and press “Enter.”<br>
</li><li>The package will then install.<br>
</li><li>Invoke the package library from the R GUI by entering “library(DivMelt)” and pressing Enter.<br>
</li><li>Initialize the package GUI from the R GUI by entering “DivMelt_gui()” and pressing Enter<br>
</li><li>The DivMelt GUI should open.</li></ol>

<br>
<br>
<h1>Preparation of Data for Analysis</h1>
<hr />
The program can analyze melt data collected from any instrument designed to measure a decline in fluorescence over an increase in temperature; however, this data must be in the proper format. Many real-time PCR systems are capable of generating suitable data, but the data files generated may not be properly formatted for analysis using this program. This software package was designed to accept data outputs from the LightScanner Instrument and Analysis Software (Idaho Technology).<br>
<br>
<h3>To prepare data for analysis:</h3>

<ol><li>Open the “LightScanner Instrument and Analysis Software.”<br>
</li><li>Open the plate file to be analyzed.<br>
</li><li>Click: “File” > ”Export” > ”Export current subset as FLO file” (this will open a “save as” window).<br>
</li><li>Save the export file set. It is suggested that the export file be saved into a directory on the desktop.<br>
<ul><li>Note: This will result in the generation of three text files in the chosen directory. Each file has a different extension.<br>
<ul><li>.FLO – Contains temperature and fluorescence values for each sample well.<br>
</li><li>.ABT – Contains sample names and sample well designations.<br>
</li><li>.TEM – Contains temperature values from the analysis.<br>
</li></ul></li></ul></li><li>Delete the “.TEM” file as this file type is not used by DivMelt.<br>
<br><br>
<h1>Analysis of Data</h1>
<hr />
<h3>To open DivMelt:</h3></li></ol>

<ol><li>Open the R GUI from the “Start” menu (Windows), a desktop shortcut (Mac or Windows), or the “Applications” menu (Mac).<br>
</li><li>In the R console:<br>
<ul><li>Type “library(DivMelt)” and press “Enter.”<br>
</li><li>Type “DivMelt_gui ()” and press “Enter.”</li></ul></li></ol>


<h3>To analyze data with DivMelt:</h3>

<ul><li>Note: See the section “DivMelt Options, Features, and Outputs” of the <a href='http://code.google.com/p/divmelt/downloads/detail?name=DivMelt_HRM_Diversity_Assay_Analysis_Tool_Instruction_Manual_V1.3.pdf&can=2&q=#makechanges'>DivMelt instruction manual</a> for detailed descriptions of the functions of each GUI element.</li></ul>

<ul><li>After loading the DivMelt library in R GUI by typing “library(DivMelt)” and pressing “Enter,” the user may view documentation describing the main routine of DivMelt by typing “?processDivMelt” in the R GUI and pressing “Enter.”</li></ul>

<ol><li>Select an input directory by clicking the ”Input Options” button then the “Input directory” button and selecting a folder from the navigation window. This folder will serve as the source for files used during the analysis. Click “OK” to finalize the selection.<br>
<ul><li>Note: DivMelt provides the user with the option of selecting a single .ABT file from a directory for analysis rather than analyzing all files in the directory. This option can be exercised by clicking the “Input file (opt)” button and selecting a specific .ABT file from the navigation window.<br>
</li><li>Note: DivMelt also provides the user with the option of restricting the analysis to a subset of the data. This can be a complete single sample name or a portion of a file name. The program will only analyze data in cases where the sample name contains the user-provided character string. If it is desirable to restrict the analysis, enter the desired character string into the blank labeled “Sample name (opt).”<br>
</li></ul></li><li>Select an output directory by clicking the “Output Options” button then the “Output directory” button and selecting a folder from the navigation window. This folder will receive the files generated during analysis. Click “OK” to finalize the selection.<br>
<ul><li>Note: DivMelt provides the user with the option of providing an alternative name for the output text file generated during the software tool run. The file name can be entered into the “Output file name (opt)” blank. The user may similarly specify a “Stats output file name (opt)” by specifying the name in the noted blank in the “Output Options” window.<br>
</li></ul></li><li>Click the “Plotting Options” button, and select the preferred plotting options. The software tool can generate PDF plots, PNG plots, or no plots based on this selection. Details of these plots are included in the “DivMelt Options, Features, and Outputs” section. Click “OK” to finalize the selection.<br>
</li><li>Click the “Analysis Options” button, and select the preferred analysis options. Default options are as follows: Exclude early peaks, on; Early peak cutoff (degrees C), 3; Exclude late peaks, on; Late peak cutoff (degrees C), 3; Include shoulders, on; Shoulder height threshold (percent), 10; Theta 1 (degrees), 50; Theta 2 (degrees), 30; T1 hold interval (degrees C), 1; T1 slope window (degrees C), 1; Theta 2 (degrees), 30; T2 hold interval (degrees C), 1; and T2 slope window (degrees C), 1. Descriptions of each analysis option are included in “Section V: DivMelt Options, Features, and Outputs.” Click “OK” to finalize the selection.<br>
<ul><li>Note: Analysis options settings can be invoked from a saved settings file. Details on the save and load settings functions can be found in the section titled “DivMelt Options, Features, and Outputs.”<br>
</li></ul></li><li>Click “Run analysis” to begin analysis of data following analysis protocol selection. A window will open asking for confirmation and summarizing the settings for the analysis. Click “OK” to begin the analysis. The analysis may take some time to complete depending upon the RAM and processor speed of your machine. A status bar “Progress of analysis…” will appear to indicate the progress of the analysis. Do not modify the R GUI or DivMelt GUI during the analysis. The analysis can be slowed by manipulations of either GUI. Another window will appear when the analysis is complete.<br>
</li><li>When the analysis is complete, view the output directory that was selected for analysis file storage. This directory will contain a set of files depending upon the selections made. By default, a summary text file will be generated. This file will contain many details of the analysis as well as the analysis results themselves. See the following section for a description of the output text files. These include the default summary file noted above plus a statistics file and a summary of rejected samples. Graphics files in the .PDF or .PNG format can also be generated.<br>
<br>
<br>
<h1>References</h1>
<hr />
</li><li>Cousins MM, Laeyendecker O, Beauchamp G, Brookmeyer R, Towler WI, et al. (2011) Use of a High Resolution Melting (HRM) Assay to Compare Gag, Pol, and Env Diversity in Adults with Different Stages of HIV Infection. PloS ONE 6: e27211.<br>
</li><li>Cousins M, Ou S-S, Wawer MJ, Munshaw S, et al. (2012) Comparison of a HRM assay to NGS for analysis of HIV diversity. J. Clin. Microbiol. 50(9): 3054-3059.</li></ol>

<br>
<h3>Further information is available in the <a href='http://code.google.com/p/divmelt/downloads/detail?name=DivMelt_HRM_Diversity_Assay_Analysis_Tool_Instruction_Manual_V1.3.pdf&can=2&q=#makechanges'>PDF instruction manual</a> that is available as a   download.</h3>
<br>
<br>

<h1>Test Dataset</h1>
<hr />
A test dataset is available for download. A description of this test datset is provided in a PDF document that is included in the archive that contains the files for the <a href='http://code.google.com/p/divmelt/downloads/detail?name=Test_dataset.zip'>test dataset</a>.